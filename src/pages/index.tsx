import { useState, useEffect } from "react";
import Loader from "../components/Loader";
import Head from "next/head";
import Header from "../components/Header";
import HeroBanner from "../components/HeroBanner";
import About from "../components/About";
import Skills from "../components/Skills";
import Projects from "../components/Projects";
import Contact from "../components/Contact";
import Link from "next/link";
import { MdArrowUpward } from "react-icons/md";
import { GetStaticProps } from "next";
import { PageInfo, Project, Skill, Social } from "../../typings";
import { fetchPageInfo } from "../../utils/fetchPageInfo";
import { fetchProjects } from "../../utils/fetchProjects";
import { fetchSkills } from "../../utils/fetchSkills";
import { fetchSocials } from "../../utils/fetchSocials";

type Props = {
  pageInfo: PageInfo;
  skills: Skill[];
  projects: Project[];
  socials: Social[];
};

const HomePage = ({ pageInfo, skills, projects, socials }: Props) => {
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const timer = setTimeout(() => {
      setLoading(false);
    }, 2800);

    return () => clearTimeout(timer);
  }, []);

  return (
    <div className="bg-[#0f0f0f] text-white h-screen snap-y snap-mandatory overflow-y-scroll overflow-x-hidden scrollbar scrollbar-track-zinc-700/20 scrollbar-thumb-[#FB923C]/80 z-0 scroll-smooth">
      <Head>
        <title>Adarsh | Portfolio</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="manifest" href="/public/manifest.json" />
        <meta name="theme-color" content="##0f0f0f" />
        <link rel="icon" href="/favicon.png" type="image/png" />
      </Head>
      {loading ? (
        <Loader />
      ) : (
        <body>
          {/* Header */}
          <Header socials={socials} />
          {/* Hero */}
          <section id="heroBanner" className="snap-start">
            <HeroBanner pageInfo={pageInfo} />
          </section>

          {/* about */}
          <section id="about" className="snap-start">
            <About pageInfo={pageInfo} />
          </section>

          {/* skills */}
          <section id="skills" className="snap-start">
            <Skills skills={skills} />
          </section>

          {/* projects */}
          <section id="projects" className="snap-start">
            <Projects projects={projects} />
          </section>

          {/* Contact */}
          <section id="contacts" className="snap-start">
            <Contact />
          </section>

          <span className="sticky bottom-9 ml-3 flex justify-start w-[70px] scroll-smooth">
            <a href="#heroBanner" aria-label="scroll to top">
              <MdArrowUpward className="animate-bounce text-4xl text-orange-500" />
            </a>
          </span>
        </body>
      )}
    </div>
  );
};

export default HomePage;

export const getStaticProps: GetStaticProps<Props> = async () => {
  const pageInfo: PageInfo = await fetchPageInfo();
  const projects: Project[] = await fetchProjects();
  const skills: Skill[] = await fetchSkills();
  const socials: Social[] = await fetchSocials();

  return {
    props: {
      pageInfo,
      projects,
      skills,
      socials,
    },
    revalidate: 1000,
  };
};
